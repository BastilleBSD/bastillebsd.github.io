<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Christer Edwards">

  
  
  
    
  
  <meta name="description" content="It&#39;s dangerous to go alone! Take this. The Bastille getting started guide will you have running containers in under twenty minutes.">

  
  <link rel="alternate" hreflang="en-us" href="https://bastillebsd.org/getting-started/">

  


  
  
  
  <meta name="theme-color" content="#800000">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-493849-18"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           document.location = url;
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target);  
  }

  gtag('js', new Date());
  gtag('config', 'UA-493849-18', { 'anonymize_ip': true });

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://bastillebsd.org/getting-started/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@BastilleBSD">
  <meta property="twitter:creator" content="@BastilleBSD">
  
  <meta property="og:site_name" content="BastilleBSD">
  <meta property="og:url" content="https://bastillebsd.org/getting-started/">
  <meta property="og:title" content="Getting Started With Bastille | BastilleBSD">
  <meta property="og:description" content="It&#39;s dangerous to go alone! Take this. The Bastille getting started guide will you have running containers in under twenty minutes."><meta property="og:image" content="https://bastillebsd.org/img/icon-192.png">
  <meta property="twitter:image" content="https://bastillebsd.org/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-01-15T12:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-01-19T13:01:28-07:00">
  

  



  


  

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#800000",
          "text": "#fff"
        },
        "button": {
          "background": "#fff",
          "text": "#800000"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "https://cookies.insites.com"
      }
    })});
</script>



  





  <title>Getting Started With Bastille | BastilleBSD</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">BastilleBSD</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/blog/"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/templates/"><span>Templates</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/getting-started/"><span>Getting Started</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/history/"><span>History</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/compare/"><span>Compare</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/contact/"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Getting Started With Bastille</h1>

  

  
    


<div class="article-metadata">

  
  

  

  

  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


  











<figure>

<img src="/img/dangerous-to-go-alone.jpg" alt="" >


  
  
  <figcaption>
    It&rsquo;s dangerous to go alone! Take this.
  </figcaption>


</figure>

<h2 id="bastille-on-freebsd">Bastille on FreeBSD</h2>
<p>This document is designed to help you be successful in your use and adoption of
Bastille and FreeBSD. This document begins with a brand-new FreeBSD 13.1 system
deployed locally or in the cloud. Manual installation is not covered in this
document.</p>
<h2 id="firstboot">Firstboot</h2>
<p>Upon logging into a system for the first time it is recommended to apply any
security patches available:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>freebsd-update fetch install
</span></span><span style="display:flex;"><span>reboot
</span></span></code></pre></div><p>After the <code>reboot</code> is complete, run <code>freebsd-update install</code> once again.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>freebsd-update install
</span></span></code></pre></div><p>Verify your version and patch level with <code>freebsd-version</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>freebsd-version
</span></span></code></pre></div><blockquote>
<p>Tip: subscribe to <a href="https://lists.freebsd.org/mailman/listinfo/freebsd-security-notifications">this mailing
list</a>
for FreeBSD security notifications (low volume). Anytime you receive an email
from this list, re-run <code>freebsd-update fetch install</code>.</p>
</blockquote>
<h2 id="packaging">Packaging</h2>
<p>FreeBSD provides binary packages, available in quarterly (default) and latest
branches. These binary packages are built from the FreeBSD ports tree, which
follows a rolling-release model. This means up-to-date packages are often
available.  To use the binary package manager, bootstrap it by running <code>pkg</code> for
the first time:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@freebsd:~ <span style="color:#75715e"># pkg bootstrap</span>
</span></span><span style="display:flex;"><span>The package management tool is not yet installed on your system.
</span></span><span style="display:flex;"><span>Do you want to fetch and install it now? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span>: y
</span></span><span style="display:flex;"><span>Bootstrapping pkg from pkg+http://pkg.FreeBSD.org/FreeBSD:13:amd64/quarterly, please wait...
</span></span><span style="display:flex;"><span>Verifying signature with trusted certificate pkg.freebsd.org.2013102301... <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>freebsd<span style="color:#f92672">]</span> Installing pkg-1.17.5...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>freebsd<span style="color:#f92672">]</span> Extracting pkg-1.17.5: 100%
</span></span><span style="display:flex;"><span>root@freebsd:~ <span style="color:#75715e">#</span>
</span></span></code></pre></div><p>Tip: this bootstrapping step can be automated using the following command:
<code>env ASSUME_ALWAYS_YES=YES pkg bootstrap</code></p>
<p><strong>Quarterly</strong></p>
<p>If you take a closer look at the line of output after the bootstrap
confirmation you&rsquo;ll notice that the last part of the URL says <code>quarterly</code>:</p>
<blockquote>
<p>Bootstrapping pkg &hellip; pkg.FreeBSD.org/FreeBSD:13:amd64/<code>quarterly</code>, please wait&hellip;</p>
</blockquote>
<p>This subscribes the host to a quarterly release cycle for binary packages. For
most systems this is adequate.  No changes are needed to subscribe to the
quarterly repository.</p>
<p><strong>Latest</strong></p>
<p>To use the latest binary packages, update the pkg URL to use the latest suffix
instead.  A simple way to override the default settings is to create a new
repository config with the updated path of <code>latest</code>.</p>
<p><strong>Migrate to latest:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mkdir -p /usr/local/etc/pkg/repos
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;FreeBSD: { url: &#39;</span>pkg+http://pkg.FreeBSD.org/<span style="color:#ae81ff">\$\{</span>ABI<span style="color:#ae81ff">\}</span>/latest<span style="color:#e6db74">&#39;, enabled: yes }&#39;</span> &gt; /usr/local/etc/pkg/repos/FreeBSD.conf
</span></span></code></pre></div><h2 id="package-basics">Package Basics</h2>
<p>In this section you&rsquo;ll learn the basics of using the package manager, and
install a few creature comforts. FreeBSD&rsquo;s binary package manager works much
like others you may have used.</p>
<p><strong>Example</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pkg install vim git-lite bash ca_root_nss
</span></span></code></pre></div><p>The above pkg install command will add the <code>vim</code>, <code>git-lite</code>, <code>bash</code> and
<code>ca_root_nss</code> (CA certificates) from the quarterly/latest repositories.
Naturally you can replace <code>bash</code> with <code>zsh</code> (or another shell of your choice).</p>
<p>You may also search the pkg repository for named packages. <code>pkg search foo</code>
will match packages including <code>foo</code>.</p>
<blockquote>
<p>Tip: Check out <a href="https://freshports.org">FreshPorts</a>.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pkg help
</span></span></code></pre></div><p>You can always find help and a list of other options using <code>pkg help</code>.</p>
<h2 id="install-bastille">Install Bastille</h2>
<p>Now that you&rsquo;ve had a crash course in package basics, let&rsquo;s install <code>bastille</code>
and start working with containers. Use one of the three options below. These
are listed in order of preference / support.</p>
<p><strong>PKG</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pkg install bastille
</span></span></code></pre></div><blockquote>
<p>Note: as outlined above, the version of Bastille installed may differ depending on whether you&rsquo;re using <code>quarterly</code> or <code>latest</code>.</p>
</blockquote>
<p><strong>PORTS</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>portsnap fetch auto
</span></span><span style="display:flex;"><span>make -C /usr/ports/sysutils/bastille install clean
</span></span></code></pre></div><p><strong>GIT(bleeding edge/unstable)</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>git clone https://github.com/BastilleBSD/bastille.git
</span></span><span style="display:flex;"><span>cd bastille
</span></span><span style="display:flex;"><span>make install
</span></span></code></pre></div><h2 id="service-management">Service Management</h2>
<p>Services in FreeBSD are managed centrally in the <code>/etc/rc.conf</code> and use a
syntax of <code>name_enable=(YES|NO)</code>. For example, to start containers
automatically at boot you can set <code>bastille_enable=YES</code> using:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sysrc bastille_enable<span style="color:#f92672">=</span>YES
</span></span></code></pre></div><p>By default, Bastille will start all created containers at boot when enabled.</p>
<p>To specify a limited list of containers to start at boot, set the optional
<code>bastille_list</code> value to the name(s) of containers to start.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sysrc bastille_list<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;azkaban arkham alcatraz&#34;</span>
</span></span></code></pre></div><p>Once services have been enabled in the <code>/etc/rc.conf</code>, they can be managed
using the <code>service</code> command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>service foo <span style="color:#f92672">[</span>start|stop|restart<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Bastille does not run as a service and does not need to be started as such.
Enabling Bastille primarily manages containers at startup and shutdown.</p>
<h2 id="bastille-containers">Bastille Containers</h2>
<p>Once Bastille is installed you&rsquo;ll want to verify the configuration. This is
where you can set the default file system (UFS or ZFS) and define the default
network interface for containers.</p>
<p><strong>/usr/local/etc/bastille/bastille.conf</strong></p>
<p>I recommend looking at the following:</p>
<h2 id="default-timezone">default timezone</h2>
<p>If you&rsquo;d prefer to set a specific timezone for your containers you may change
it here. The default is to use the timezone of the host.</p>
<p>Requires format &ldquo;America/Denver&rdquo; or &ldquo;Europe/Paris&rdquo;.  (see <code>/usr/share/zoneinfo</code>)</p>
<pre tabindex="0"><code>bastille_tzdata=&#34;&#34;  ## default: empty to use host&#39;s time zone
</code></pre><h2 id="zfs-recommended">ZFS (recommended)</h2>
<p>If your system uses ZFS as a filesystem you can make use of that here. Set the
enable option to <code>YES</code> and define the <code>zpool</code>. If either is undefined ZFS will
not be used.</p>
<pre tabindex="0"><code>## ZFS options
bastille_zfs_enable=&#34;&#34;  ## default: &#34;&#34;
bastille_zfs_zpool=&#34;&#34;   ## default: &#34;&#34;
</code></pre><h2 id="networking">Networking</h2>
<p>Bastille can be flexible about the way it handles networking. In this document
we will use the more portable &ldquo;loopback&rdquo; network design. This can be used in
the same way in the cloud or on local networks. Bastille uses this method by default.</p>
<p>If you&rsquo;d like to use an alternate method, refer to the <a href="https://docs.bastillebsd.org/en/latest/chapters/networking.html">Bastille Networking
Documentation</a>.</p>
<p>There is a one-time setup requirement to configure a new <code>bastille0</code> loopback
interface and define firewall rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sysrc cloned_interfaces<span style="color:#f92672">+=</span>lo1
</span></span><span style="display:flex;"><span>sysrc ifconfig_lo1_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bastille0&#34;</span>
</span></span><span style="display:flex;"><span>service netif cloneup
</span></span></code></pre></div><p>With this in place we can create the firewall rules that will both limit access
to the host system and containers, and also provide a NAT rule for the new
<code>bastille0</code> loopback interface to access the broader network.</p>
<p>Create <code>/etc/pf.conf</code> and use the following rules:</p>
<pre tabindex="0"><code>ext_if=&#34;vtnet0&#34;

set block-policy return
scrub in on $ext_if all fragment reassemble
set skip on lo

table &lt;jails&gt; persist
nat on $ext_if from &lt;jails&gt; to any -&gt; ($ext_if:0)
rdr-anchor &#34;rdr/*&#34;

block in all
pass out quick keep state
antispoof for $ext_if inet
pass in inet proto tcp from any to any port ssh flags S/SA keep state
</code></pre><blockquote>
<p>IMPORTANT: Update <code>ext_if=&quot;vtnet0&quot;</code> with the name of your external interface as needed.</p>
</blockquote>
<p>This is a sane and simple ruleset that will allow all traffic outbound and
block all traffic inbound (with the exception of allowing SSH traffic in). It
is also what provides external network access to the containers by way of the
<code>table</code> and <code>nat</code> rule. Without those rules there is no external network access
for the containers.</p>
<p>Finally enable and start the firewall.</p>
<blockquote>
<p>Tip: Starting the firewall will disconnect any remote sessions (ie; the
connection you may be using now). SSH inbound access is allowed by the new
policy, simply reconnect.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sysrc pf_enable<span style="color:#f92672">=</span>YES
</span></span><span style="display:flex;"><span>service pf start
</span></span></code></pre></div><p>Now equipped with a robust firewall and a sane configuration you&rsquo;re ready to
bootstrap a release and begin creating containers!</p>
<h2 id="bootstrap">bootstrap</h2>
<p>To <code>bootstrap</code> a release for use with your container use the <code>bootstrap</code>
sub-command.</p>
<blockquote>
<p>You can optionally append the keyword <code>update</code> to automagically apply <code>freebsd-update</code> to the downloaded release.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille bootstrap 13.1-RELEASE update
</span></span></code></pre></div><p>You can now create a container using the newly bootstrapped release.</p>
<h2 id="create">create</h2>
<p>In order to create a container you will need to provide a unique container
name, a bootstrapped release name and static IP address.</p>
<p>You can use any (<a href="https://tools.ietf.org/html/rfc1918">rfc1918</a>) private IP
range for your containers. For example, unless your host IP also has a 10.x.x.x
IP, it&rsquo;s safe to use any address within that range.</p>
<p>IP options include: <code>10.0.0.0/8</code>, <code>172.16.0.0/12</code> and <code>192.168.0.0/16</code>.</p>
<blockquote>
<p>Tip: container names cannot include the dot (&quot;.&quot;) character.</p>
</blockquote>
<p>Container creation should be very quick.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille create alcatraz 13.1-RELEASE 10.17.89.50
</span></span></code></pre></div><h2 id="list">list</h2>
<p>You can list running containers.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille list
</span></span></code></pre></div><h2 id="pkg">pkg</h2>
<p>Install packages inside the container.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille pkg alcatraz install -y htop
</span></span></code></pre></div><h2 id="htop">htop</h2>
<p>htop is an interactive process viewer. When you view processes inside a
container you only see that container&rsquo;s processes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille htop alcatraz
</span></span></code></pre></div><p>Notice that <code>syslogd</code> and <code>cron</code> are the only default processes.</p>



  











<figure>

<img src="/img/bastille-htop-alcatraz.png" alt="" >


  
  
  <figcaption>
    Interactive Process Viewer
  </figcaption>


</figure>

<p>Tip: Press &ldquo;q&rdquo; to quit.</p>
<h2 id="sysrc">sysrc</h2>
<p>Let&rsquo;s toggle a setting inside the container and enable the <code>sshd</code> service.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille sysrc alcatraz sshd_enable<span style="color:#f92672">=</span>YES
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>alcatraz<span style="color:#f92672">]</span>:
</span></span><span style="display:flex;"><span>sshd_enable: NO -&gt; YES
</span></span></code></pre></div><h2 id="service">service</h2>
<p>Start up the newly enabled service.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille service alcatraz sshd start
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>alcatraz<span style="color:#f92672">]</span>:
</span></span><span style="display:flex;"><span>Generating RSA host key.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2048</span> SHA256:PsH1pAJbRC4hup+jyDxhFxhMHcGrYBWr5aL84y3Bjc0 root@alcatraz <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Generating ECDSA host key.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">256</span> SHA256:eqCAkH/tW2OnrV4B3BflK76ZV08jWGfoHF7AX/iPvM8 root@alcatraz <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Generating ED25519 host key.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">256</span> SHA256:1GFg1+agxbEZpernrtrcKEfLzWcih+2xRaOe97fmMcU root@alcatraz <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Performing sanity check on sshd configuration.
</span></span><span style="display:flex;"><span>Starting sshd.
</span></span></code></pre></div><h2 id="cmd">cmd</h2>
<p>Execute arbitrary commands inside the container. In this case check to see that
<code>sshd</code> is listening on port <code>:22</code> using the <code>sockstat -4</code> command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille cmd alcatraz sockstat -4
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>alcatraz<span style="color:#f92672">]</span>:
</span></span><span style="display:flex;"><span>USER     COMMAND    PID   FD PROTO  LOCAL ADDRESS         FOREIGN ADDRESS
</span></span><span style="display:flex;"><span>root     sshd       <span style="color:#ae81ff">34994</span> <span style="color:#ae81ff">4</span>  tcp4   10.17.89.50:22        *:*
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>alcatraz<span style="color:#f92672">]</span>: <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h2 id="console">console</h2>
<p>Finally, use <code>console</code> for a password-less root login to the container and have
a look around. You&rsquo;ll find yourself in a wholly contained FreeBSD system with
the ability to build whatever you need to build.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille console alcatraz
</span></span></code></pre></div><p>The <code>root</code> user is still (mostly) all powerful, but only within the confines of
that container.</p>
<p>When you&rsquo;re finished, log out of the container as normal with <code>exit</code> or
<code>ctrl-d</code>.</p>
<h2 id="stop">stop</h2>
<p>When you&rsquo;re done testing your container you can shut it off.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille stop alcatraz
</span></span></code></pre></div><h2 id="destroy">destroy</h2>
<p>Lastly, destroy your lightweight container.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>bastille destroy alcatraz
</span></span></code></pre></div><h2 id="usage">usage</h2>
<pre tabindex="0"><code>Bastille is an open-source system for automating deployment and management of
containerized applications on FreeBSD.

Usage:
  bastille command TARGET [args]

Available Commands:
  bootstrap   Bootstrap a FreeBSD release for container base.
  cmd         Execute arbitrary command on targeted container(s).
  clone       Clone an existing container.
  config      Get or set a config value for the targeted container(s).
  console     Console into a running container.
  convert     Convert a Thin container into a Thick container.
  cp          cp(1) files from host to targeted container(s).
  create      Create a new thin container or a thick container if -T|--thick option specified.
  destroy     Destroy a stopped container or a FreeBSD release.
  edit        Edit container configuration files (advanced).
  export      Exports a specified container.
  help        Help about any command.
  htop        Interactive process viewer (requires htop).
  import      Import a specified container.
  limits      Apply resources limits to targeted container(s). See rctl(8).
  list        List containers (running and stopped).
  mount       Mount a volume inside the targeted container(s).
  pkg         Manipulate binary packages within targeted container(s). See pkg(8).
  rdr         Redirect host port to container port.
  rename      Rename a container.
  restart     Restart a running container.
  service     Manage services within targeted container(s).
  start       Start a stopped container.
  stop        Stop a running container.
  sysrc       Safely edit rc files within targeted container(s).
  template    Apply file templates to targeted container(s).
  top         Display and update information about the top(1) cpu processes.
  umount      Unmount a volume from within the targeted container(s).
  update      Update container base -pX release.
  upgrade     Upgrade container release to X.Y-RELEASE.
  verify      Compare release against a &#34;known good&#34; index.
  zfs         Manage (get|set) ZFS attributes on targeted container(s).

Use &#34;bastille -v|--version&#34; for version information.
Use &#34;bastille command -h|--help&#34; for more information about a command.
</code></pre><hr>
<p>To learn more about automating containerized applications, see
the <a href="https://docs.bastillebsd.org">Bastille Documentation</a>.</p>
<hr>

    </div>

    







<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://bastillebsd.org/getting-started/&amp;text=Getting%20Started%20With%20Bastille" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://bastillebsd.org/getting-started/&amp;t=Getting%20Started%20With%20Bastille" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Getting%20Started%20With%20Bastille&amp;body=https://bastillebsd.org/getting-started/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://bastillebsd.org/getting-started/&amp;title=Getting%20Started%20With%20Bastille" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Getting%20Started%20With%20Bastille%20https://bastillebsd.org/getting-started/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://bastillebsd.org/getting-started/&amp;title=Getting%20Started%20With%20Bastille" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>















  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/shell.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    

    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.49e3cb989a551c31bb54456065080d29.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    © 2018-2022 &middot; 

    BastilleBSD 

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
